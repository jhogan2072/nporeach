  <% if @creditcard.errors.any? %>
    <div class="errorExplanation">
      <h2>Errors encountered with your payment information:</h2>
      <ul>
        <%= raw(@creditcard.errors.full_messages.map {|m| content_tag('li', h(m))}) %>
      </ul>
    </div>
  <% end %>

  <% if @address.errors.any? %>
    <div class="errorExplanation">
      <h2>Errors encountered with your address:</h2>
      <ul>
        <%= raw(@address.errors.full_messages.map {|m| content_tag('li', h(m))}) %>
      </ul>
    </div>
  <% end %>

  <% if @subscription && @subscription.errors.any? %>
    <div class="errorExplanation">
      <h2>Errors encountered with your payment:</h2>
      <ul>
        <%= raw(@subscription.errors.full_messages.map {|m| content_tag('li', h(m))}) %>
      </ul>
    </div>
  <% end %>


<fieldset>
  <legend><%= t('shared.credit_card_form.enterpaymentinfo', stepno: 3) %></legend>
  <% if @subscription %>
    <h2><input type="radio" name="paypal" value=" " <%= 'checked="checked"' unless @subscription.paypal? %>> Pay with a credit card</h2>
  <% end %>
  <div class="unit">
    <label><%= t('shared.credit_card_form.nameoncard') %></label>
    <%= text_field :creditcard, :first_name, :size => 20 %>
    <%= text_field :creditcard, :last_name, :size => 20 %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.cardnumber') %></label>
    <%= text_field :creditcard, :number, :size => 20 %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.type') %></label>
    <%= select :creditcard, :type, Saas::Config.gateway == "bogus" ? [['Bogus', 'bogus']] : [['Visa', 'visa'], ['MasterCard', 'master'], ['American Express', 'american_express']] %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.expiration') %></label>
    <%= select :creditcard, :month, (1 .. 12) %>
    <%= select :creditcard, :year, (Time.now.year .. 10.years.from_now.year) %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.cvv') %></label>
    <%= text_field :creditcard, :verification_value, :size => 4 %>
    <%= image_tag('cvv.gif', :size => '51x31', :align => 'top') %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.address') %></label>
    <%= text_field :address, :address1 %><br/>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.address2') %></label>
    <%= text_field :address, :address2 %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.city') %></label>
    <%= text_field :address, :city %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.state') %></label>
    <%= text_field :address, :state %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.zip') %></label>
    <%= text_field :address, :zip %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.country') %></label>
    <%= country_select :address, :country, ['United States', 'Canada'] %>
  </div>
  <div class="unit">
    <label><%= t('shared.credit_card_form.phone') %></label>
    <%= text_field :address ,:phone %>
  </div>
</fieldset>

<% if @subscription %>
  <fieldset>
    <h2><input type="radio" name="paypal" value="true" <%= 'checked="checked"' if @subscription.paypal? %>> Pay with PayPal </h2>
  </fieldset>
<% end %>
